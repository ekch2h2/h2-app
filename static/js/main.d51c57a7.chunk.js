(this["webpackJsonph2-app-webapp"]=this["webpackJsonph2-app-webapp"]||[]).push([[0],{106:function(e,t,n){e.exports=n.p+"static/media/no-img.77f5794e.png"},107:function(e,t,n){e.exports=n.p+"static/media/icon.10f8d0e1.png"},209:function(e,t,n){e.exports=n(344)},214:function(e,t,n){},344:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(11),c=n.n(o),l=n(25),i=n(24),s=(n(214),n(381)),u=n(133),m=n.n(u),d={palette:{primary:{light:"#33c9dc",main:"#00bcd4",dark:"#008394",contrastText:"#fff"},secondary:{light:"#ff6333",main:"#ff3d00",dark:"#b22a00",contrastText:"#fff"}},typography:{useNextVariants:!0},rootStyles:{form:{textAlign:"center"},image:{margin:"20px auto 20px auto"},pageTitle:{margin:"10px auto 10px auto"},textField:{margin:"10px auto 10px auto"},button:{marginTop:20,position:"relative"},customError:{color:"red",fontSize:"0.8rem",marginTop:10},progress:{position:"absolute"},invisibleSeparator:{border:"none",margin:4},visibleSeparator:{width:"100%",borderBottom:"1px solid rgba(0, 0, 0, 0.1)",marginBottom:20},paper:{padding:20},profile:{"& .image-wrapper":{textAlign:"center",position:"relative","& button":{position:"absolute",top:"80%",left:"70%"}},"& .profile-image":{width:200,height:200,objectFit:"cover",maxWidth:"100%",borderRadius:"50%"},"& .profile-details":{textAlign:"center","& span, svg":{verticalAlign:"middle"},"& a":{color:"#00bcd4"}},"& hr":{border:"none",margin:"0 0 10px 0"},"& svg.button":{"&:hover":{cursor:"pointer"}}},buttons:{textAlign:"center","& a":{margin:"20px 10px"}},closeButton:{position:"absolute",right:"0.2rem",top:"0.4rem"}}},p=n(22),h=n.n(p),f=n(12),E=n(51),b=n(180),g=n(84),y=n(6),v={authenticated:!1,credentials:{},likes:[],notifications:[],loading:!1},O={announcements:[],announcement:{},loading:!1},N={loading:!1,errors:null},C=[b.a],j=Object(E.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_AUTHENTICATED":return Object(y.a)(Object(y.a)({},e),{},{authenticated:!0});case"SET_UNAUTHENTICATED":return v;case"SET_USER":return Object(y.a)({loading:!1,authenticated:!0},t.payload);case"LOADING_USER":return Object(y.a)(Object(y.a)({},e),{},{loading:!0});case"LIKE_ANNOUNCEMENT":return Object(y.a)(Object(y.a)({},e),{},{likes:[].concat(Object(g.a)(e.likes),[{userHandle:e.credentials.handle,announcementId:t.payload.announcementId}])});case"UNLIKE_ANNOUNCEMENT":return Object(y.a)(Object(y.a)({},e),{},{likes:e.likes.filter((function(e){return e.announcementId!==t.payload.announcementId}))});case"MARK_NOTIFCATIONS_READ":return e.notifications.forEach((function(e){return e.read=!0})),Object(y.a)({},e);default:return e}},data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOADING_DATA":return Object(y.a)(Object(y.a)({},e),{},{loading:!0});case"SET_ANNOUNCEMENTS":return Object(y.a)(Object(y.a)({},e),{},{announcements:t.payload,loading:!1});case"SET_ANNOUNCEMENT":return Object(y.a)(Object(y.a)({},e),{},{announcement:t.payload});case"APPEND_IMAGEURL_TO_ANNOUNCEMENT":return Object(y.a)(Object(y.a)({},e),{},{announcement:Object(y.a)(Object(y.a)({},e.announcement),{},{body:"".concat(e.announcement.body,"\n\n![](").concat(t.payload,")")})});case"LIKE_ANNOUNCEMENT":case"UNLIKE_ANNOUNCEMENT":var n=e.announcements.findIndex((function(e){return e.announcementId===t.payload.announcementId}));return e.announcements[n]=t.payload,e.announcement.announcementId===t.payload.announcementId&&(e.announcement=Object(y.a)(Object(y.a)({},e.announcement),t.payload)),Object(y.a)({},e);case"DELETE_ANNOUNCEMENT":var a=e.announcements.findIndex((function(e){return e.announcementId===t.payload}));return e.announcements.splice(a,1),Object(y.a)({},e);case"POST_ANNOUNCEMENT":return Object(y.a)(Object(y.a)({},e),{},{announcements:[t.payload].concat(Object(g.a)(e.announcements))});case"SUBMIT_COMMENT":return Object(y.a)(Object(y.a)({},e),{},{announcement:Object(y.a)(Object(y.a)({},e.announcement),{},{comments:[t.payload].concat(Object(g.a)(e.announcement.comments))})});default:return e}},UI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){default:return e;case"SET_ERRORS":return Object(y.a)(Object(y.a)({},e),{},{loading:!1,errors:t.payload});case"CLEAR_ERRORS":return Object(y.a)(Object(y.a)({},e),{},{loading:!1,errors:null});case"LOADING_UI":return Object(y.a)(Object(y.a)({},e),{},{loading:!0});case"STOP_LOADING_UI":return Object(y.a)(Object(y.a)({},e),{},{loading:!1})}}}),S=Object(E.e)(j,{},function(){var e=window.navigator.userAgent;return e.includes("Chrome")&&!e.includes("Windows")&&!e.includes("Android")}()?Object(E.d)(E.a.apply(void 0,C),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()):Object(E.d)(E.a.apply(void 0,C))),w=n(75),I=function(e){h.a.defaults.headers.common.Authentication="Bearer ".concat(e)},A=function(){return function(e){e({type:"LOADING_USER"}),h.a.get("/user").then((function(t){e({type:"SET_USER",payload:t.data})})).catch((function(t){console.log(t),e({type:"SET_ERRORS",payload:t.response.data})}))}},k=n(15),x=n(16),U=n(18),T=n(17),_=n(383),R=n(384),D=n(14),L=n.n(D),M=n(396),P=n(376),B=function(e){var t=e.children,n=e.onClick,a=e.tip,o=e.btnClassName,c=e.tipClassName;return r.a.createElement(M.a,{title:a,placement:"top",className:c},r.a.createElement(P.a,{onClick:n,className:o},t))},W=n(140),F=n.n(W),G=n(38),H=function(){return function(e){e({type:"LOADING_DATA"}),h.a.get("/announcements").then((function(t){e({type:"SET_ANNOUNCEMENTS",payload:t.data.map((function(e){return Object(y.a)(Object(y.a)({},e),{},{announcementId:e.announcementId})}))})})).catch((function(t){e({type:"SET_ANNOUNCEMENTS",payload:[]})}))}},z=function(){return function(e){e({type:"CLEAR_ERRORS"})}},K=n(349),Y=n(379),V=n(395),J=n(378),X=n(377),$=n(380),q=n(182),Q=n.n(q),Z=n(104),ee=n.n(Z),te=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(k.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={open:!1,body:"",errors:{}},e.handleOpen=function(){e.setState({open:!0})},e.handleClose=function(){e.props.clearErrors(),e.setState({open:!1,errors:{}})},e.handleChange=function(t){e.setState(Object(G.a)({},t.target.name,t.target.value))},e.handleSubmit=function(t){t.preventDefault(),e.props.postAnnouncement({body:e.state.body})},e}return Object(x.a)(n,[{key:"componentWillReceiveProps",value:function(e,t){e.UI.errors&&this.setState({errors:e.UI.errors}),e.UI.errors||e.UI.loading||this.setState({body:"",open:!1})}},{key:"render",value:function(){var e=this.state.errors,t=this.props,n=t.classes,o=t.UI.loading;return r.a.createElement(a.Fragment,null,r.a.createElement(B,{onClick:this.handleOpen,tip:"Post an Announcement!"},r.a.createElement(Q.a,null)),r.a.createElement(V.a,{open:this.state.open,onClose:this.handleClose,fullWidth:!0,maxWidth:"md"},r.a.createElement(B,{tip:"Close",onClick:this.handleClose,tipClassName:n.closeButton},r.a.createElement(ee.a,null)),r.a.createElement(X.a,null,"Post a new announcement"),r.a.createElement(J.a,null,r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(Y.a,{name:"body",type:"text",label:"Content",multiline:!0,placeholder:"Announcement content with markdown",error:!!e.body,helperText:e.body,className:n.textField,onChange:this.handleChange,fullWidth:!0,rows:"6",rowsMax:"12"}),r.a.createElement(K.a,{type:"submit",variant:"contained",color:"primary",className:n.submitButton,disabled:o},"Submit",o&&r.a.createElement($.a,{size:30,className:n.progressSpinner}))))))}}]),n}(a.Component),ne=Object(f.b)((function(e){return{UI:e.UI}}),{postAnnouncement:function(e){return function(t){t({type:"LOADING_UI"}),h.a.post("/announcement",e).then((function(e){t({type:"POST_ANNOUNCEMENT",payload:Object(y.a)(Object(y.a)({},e.data),{},{announcementId:e.data.announcementId})}),t(z())})).catch((function(e){t({type:"SET_ERRORS",payload:e.response.data})}))}},clearErrors:z})(L()((function(e){return Object(y.a)(Object(y.a)({},e.rootStyles),{},{submitButton:{margin:"10px auto 10px auto",position:"relative",float:"right"},progressSpinner:{position:"absolute"}})}))(te)),ae=n(59),re=n.n(ae),oe=n(105),ce=n.n(oe),le=n(194),ie=n(397),se=n(382),ue=n(77),me=n(184),de=n.n(me),pe=n(183),he=n.n(pe),fe=n(112),Ee=n.n(fe),be=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(k.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={anchorEl:null},e.handleOpen=function(t){e.setState({anchorEl:t.target})},e.handleClose=function(){e.setState({anchorEl:null})},e.onMenuOpened=function(){var t=e.props.notifications.filter((function(e){return!e.read})).map((function(e){return e.notificationId}));e.props.markNotificationsRead(t)},e}return Object(x.a)(n,[{key:"render",value:function(){var e,t=this,n=this.props.notifications,o=this.state.anchorEl;if(re.a.extend(ce.a),n&&n.length>0){var c=n.filter((function(e){return!1===e.read})).length;e=c>0?r.a.createElement(se.a,{badgeContent:c,color:"secondary"},r.a.createElement(Ee.a,null)):r.a.createElement(Ee.a,null)}else e=r.a.createElement(Ee.a,null);var i=n&&n.length>0?n.map((function(e){var n="like"===e.type?"liked":"commented on",a=re()(e.createdAt).fromNow(),o=e.read?"primary":"secondary",c="like"===e.type?r.a.createElement(he.a,{color:o,style:{marginRight:10}}):r.a.createElement(de.a,{color:o,style:{marginRight:10}});return r.a.createElement(ie.a,{key:e.createdAt,onClick:t.handleClose},c,r.a.createElement(ue.a,{component:l.b,color:"default",variant:"body1",to:"/users/".concat(e.recipient,"/announcement/").concat(e.announcementId)},e.sender," ",n," your announcement ",a))})):r.a.createElement(ie.a,{onClick:this.handleClose},"You have no notifications yet");return r.a.createElement(a.Fragment,null,r.a.createElement(M.a,{placement:"top",title:"Notifications"},r.a.createElement(P.a,{"aria-owns":o?"simple-menu":void 0,"aria-haspopup":"true",onClick:this.handleOpen},e)),r.a.createElement(le.a,{anchorEl:o,open:Boolean(o),onClose:this.handleClose,onEntered:this.onMenuOpened},i))}}]),n}(a.Component),ge=Object(f.b)((function(e){return{notifications:e.user.notifications}}),{markNotificationsRead:function(e){return function(t){h.a.post("/notifications",e).then((function(e){t({type:"MARK_NOTIFCATIONS_READ"})})).catch((function(e){console.log(e)}))}}})(be),ye=n(185),ve=n.n(ye),Oe=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(){return Object(k.a)(this,n),t.apply(this,arguments)}return Object(x.a)(n,[{key:"render",value:function(){var e=this.props,t=e.authenticated,n=e.isAnnouncementProvider;return r.a.createElement(_.a,null,r.a.createElement(R.a,{className:"nav-container"},t?r.a.createElement(a.Fragment,null,n?r.a.createElement(ne,null):r.a.createElement("div",null),r.a.createElement(l.b,{to:"/"},r.a.createElement(B,{tip:"Home"},r.a.createElement(F.a,null))),r.a.createElement(ge,null)):r.a.createElement(a.Fragment,null,r.a.createElement(l.b,{to:"/login"},r.a.createElement(B,{tip:"Account login"},r.a.createElement(ve.a,null))),r.a.createElement(l.b,{to:"/"},r.a.createElement(B,{tip:"Home"},r.a.createElement(F.a,null))))))}}]),n}(a.Component),Ne=Object(f.b)((function(e){return{authenticated:e.user.authenticated,isAnnouncementProvider:e.user.credentials.isAnnouncementProvider}}))(L()({})(Oe)),Ce=n(195),je=Object(f.b)((function(e){return{authenticated:e.user.authenticated}}))((function(e){var t=e.component,n=e.authenticated,a=Object(Ce.a)(e,["component","authenticated"]);return r.a.createElement(i.b,Object.assign({},a,{render:function(e){return!0===n?r.a.createElement(i.a,{to:"/"}):r.a.createElement(t,e)}}))})),Se=n(3),we=n(74),Ie=n.n(we),Ae=n(187),ke=n.n(Ae),xe=n(186),Ue=n.n(xe),Te=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(e){var a;return Object(k.a)(this,n),(a=t.call(this,e)).state={open:!1,oldPath:"",newPath:"",errors:{},body:""},a.handleOpen=function(){var e=window.location.pathname,t=a.props,n=t.userHandle,r=t.announcementId,o="/users/".concat(n,"/announcement/").concat(r);e===o&&(e="/users/".concat(n)),window.history.pushState(null,null,o),a.setState({open:!0,oldPath:e,newPath:o}),a.props.getAnnouncement(a.props.announcementId)},a.handleClose=function(){window.history.pushState(null,null,a.state.oldPath),a.setState({open:!1}),a.props.clearErrors()},a.handleSubmit=function(e){e.preventDefault(),a.props.updateAnnouncement(a.props.announcementId,a.state.body)},a.handleChange=function(e){a.setState(Object(G.a)({},e.target.name,e.target.value))},a.handleImageChange=function(e){var t=e.target.files[0],n=new FormData;n.append("image",t,t.name),a.props.uploadImageForPost(a.props.announcementId,n)},a.handleEditPicture=function(){a.imageButtonRef.current.click()},a.imageButtonRef=r.a.createRef(),a}return Object(x.a)(n,[{key:"componentWillReceiveProps",value:function(e,t){e.UI.errors&&this.setState({errors:e.UI.errors}),e.announcement.body&&this.setState({body:e.announcement.body})}},{key:"componentDidMount",value:function(){this.props.openDialog&&this.handleOpen()}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.UI.loading,o=this.state,c=o.body,l=o.errors,i=n?r.a.createElement("div",{className:t.spinnerDiv},r.a.createElement($.a,{size:200})):r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement(Ue.a,{name:"body",type:"text",label:"Content",multiline:!0,placeholder:"Announcement content with markdown",error:!!l.body,helperText:l.body,className:t.textField,onChange:this.handleChange,fullWidth:!0,value:c,rows:"6",rowsMax:"12"}),r.a.createElement("input",{type:"file",id:"imageInput",hidden:"hidden",onChange:this.handleImageChange,ref:this.imageButtonRef}),r.a.createElement(K.a,{variant:"contained",color:"primary",className:t.toolButton,disabled:n,onClick:this.handleEditPicture},r.a.createElement(ke.a,null)),r.a.createElement(K.a,{type:"submit",variant:"contained",color:"primary",className:t.submitButton,disabled:n},"Submit",n&&r.a.createElement($.a,{size:30,className:t.progressSpinner})));return r.a.createElement(a.Fragment,null,r.a.createElement(B,{onClick:this.handleOpen,tip:"Edit announcement",tipClassName:t.expandButton},r.a.createElement(Ie.a,{color:"primary"})),r.a.createElement(V.a,{open:this.state.open,onClose:this.handleClose,fullWidth:!0,maxWidth:"md"},r.a.createElement(B,{tip:"Close",onClick:this.handleClose,tipClassName:t.closeButton},r.a.createElement(ee.a,null)),r.a.createElement(J.a,{className:t.dialogContent},i)))}}]),n}(a.Component),_e=Object(f.b)((function(e){return{announcement:e.data.announcement,UI:e.UI}}),{getAnnouncement:function(e){return function(t){t({type:"LOADING_UI"}),h.a.get("/announcement/".concat(e)).then((function(e){t({type:"SET_ANNOUNCEMENT",payload:Object(y.a)(Object(y.a)({},e.data),{},{announcementId:e.data.announcementId})}),t({type:"STOP_LOADING_UI"})})).catch((function(e){console.log(e)}))}},updateAnnouncement:function(e,t){return function(n){n({type:"LOADING_UI"}),h.a.post("/announcement/".concat(e),{body:t}).then((function(){n(H())})).catch((function(e){n({type:"SET_ERRORS",payload:e.response.data})}))}},uploadImageForPost:function(e,t){return function(n){n({type:"LOADING_USER"}),h.a.post("/announcement/".concat(e,"/image"),t).then((function(e){n({type:"APPEND_IMAGEURL_TO_ANNOUNCEMENT",payload:e.data.imageUrl})})).catch((function(e){return console.log(e)}))}},clearErrors:z})(L()((function(e){return Object(y.a)(Object(y.a)({},e.rootStyles),{},{avatar:{height:"80%",width:"80%"},dialogContent:{padding:20},expandButton:{float:"right"},spinnerDiv:{textAlign:"center",marginTo:50,marginBottom:50},submitButton:{margin:"10px auto 10px auto",position:"relative",float:"right"},toolButton:{margin:"10px auto 10px auto",position:"relative",float:"left"}})}))(Te)),Re=n(385),De=n(188),Le=n.n(De),Me=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(k.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={open:!1},e.handleOpen=function(){e.setState({open:!0})},e.handleClose=function(){e.setState({open:!1})},e.deleteAnnouncement=function(){e.props.deleteAnnouncement(e.props.announcementId),e.handleClose()},e}return Object(x.a)(n,[{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(a.Fragment,null,r.a.createElement(B,{tip:"Delete Announcement",onClick:this.handleOpen,btnClassName:e.deleteButton},r.a.createElement(Le.a,{color:"primary"})),r.a.createElement(V.a,{open:this.state.open,onClose:this.handleClose,fullWidth:!0,maxWidth:"sm"},r.a.createElement(X.a,null,"Are you sure you want to delete this announcement?"),r.a.createElement(Re.a,null,r.a.createElement(K.a,{onClick:this.handleClose,color:"primary"},"Cancel"),r.a.createElement(K.a,{onClick:this.deleteAnnouncement,color:"secondary"},"Delete"))))}}]),n}(a.Component),Pe=Object(f.b)(null,{deleteAnnouncement:function(e){return function(t){h.a.delete("/announcement/".concat(e)).then((function(){t({type:"DELETE_ANNOUNCEMENT",payload:e})})).catch((function(e){return console.log(e)}))}}})(L()({})(Me)),Be=n(398),We=n(387),Fe=n(388),Ge=n(390),He=n(386),ze=n(189),Ke=n.n(ze),Ye=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(k.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={open:!1},e.handleOpen=function(){e.setState({open:!0})},e.handleClose=function(){e.setState({open:!1})},e.archiveAnnouncement=function(){e.props.archiveAnnouncement(e.props.announcementId),e.handleClose()},e}return Object(x.a)(n,[{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(a.Fragment,null,r.a.createElement(B,{tip:"Archive Announcement",onClick:this.handleOpen,btnClassName:e.archiveButton},r.a.createElement(Ke.a,{color:"primary"})),r.a.createElement(V.a,{open:this.state.open,onClose:this.handleClose,fullWidth:!0,maxWidth:"sm"},r.a.createElement(X.a,null,"Are you sure you want to archive this announcement?"),r.a.createElement(Re.a,null,r.a.createElement(K.a,{onClick:this.handleClose,color:"primary"},"Cancel"),r.a.createElement(K.a,{onClick:this.archiveAnnouncement,color:"secondary"},"Archive"))))}}]),n}(a.Component),Ve=Object(f.b)(null,{archiveAnnouncement:function(e){return function(t){h.a.post("/announcement/".concat(e),{isArchived:!0}).then((function(){t(H())})).catch((function(e){t({type:"SET_ERRORS",payload:e.response.data})}))}}})(L()({})(Ye)),Je=n(190),Xe=n.n(Je);function $e(e){return e.match(/^[0-9]+\. /)||e.match(/^\* /)}function qe(e){var t="",n="";return e.split("\n").forEach((function(e){var a=e.trim();!$e(n)&&$e(a)&&(t+="\n"),t+=a.replace("\u3002"," \u3002 ")+"\n",n=a})),t}var Qe=n(192),Ze=n.n(Qe),et=n(389),tt=n(191),nt=n.n(tt),at=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(k.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).handleShare=function(){var t=e.props.content,n={title:"H2 App",text:t,url:"https://ekch2h2.github.io/h2-app/?content=".concat(encodeURIComponent(t))};try{navigator.share(n),console.log("Shared successfully")}catch(a){console.log("Share failed")}},e.canShare=function(){try{return navigator.canShare}catch(e){return!1}},e}return Object(x.a)(n,[{key:"render",value:function(){var e=this.props.classes;return this.canShare()?r.a.createElement("div",null,r.a.createElement(B,{onClick:this.handleShare,tip:"Share announcement",tipClassName:e.expandButton},r.a.createElement(nt.a,{color:"primary"}))):null}}]),n}(a.Component),rt=L()((function(e){return Object(y.a)({},e.rootStyles)}))(at),ot=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(e){var a;return Object(k.a)(this,n),(a=t.call(this,e)).state={expanded:!1,dimensions:null},a.toggleExpandContent=function(){a.setState((function(e){return{expanded:!e.expanded}}))},a.container=r.a.createRef(),a}return Object(x.a)(n,[{key:"updateContentDimensions",value:function(){this.setState({dimensions:{width:this.container.current.offsetWidth,height:this.container.current.offsetHeight}})}},{key:"componentDidMount",value:function(){this.updateContentDimensions()}},{key:"componentDidUpdate",value:function(e,t,n){null!=t.dimensions&&t.dimensions.height===this.container.current.offsetHeight||this.updateContentDimensions()}},{key:"shouldShowMore",value:function(){var e=this.state.dimensions;return e&&e.height>=this.collapsedHeight()}},{key:"collapsedHeight",value:function(){var e=this.state.dimensions;return e?e.width>500?150:250:150}},{key:"render",value:function(){re.a.extend(ce.a);var e=this.props,t=e.classes,n=e.announcement,a=n.body,o=n.createdAt,c=n.userImage,i=n.userHandle,s=n.announcementId,u=e.user,m=u.authenticated,d=u.credentials.handle,p=this.state.expanded,h=m&&i===d?r.a.createElement(Pe,{announcementId:s}):null,f=m&&i===d?r.a.createElement(_e,{announcementId:s,userHandle:i}):null,E=m&&i===d?r.a.createElement(Ve,{announcementId:s,userHandle:i}):null,b=r.a.createElement(rt,{content:a}),g=r.a.createElement(He.a,{classes:t.buttonGroup},b,f,E,h),y=r.a.createElement(ue.a,{component:l.b,to:"/users/".concat(i),color:"primary"},i),v=r.a.createElement("div",{className:Object(Se.default)(t.showMoreContainer)},r.a.createElement(K.a,{onClick:this.toggleExpandContent,className:Object(Se.default)(t.showMore),variant:"outlined",color:"primary",size:"small"},"Show ",p?"Less":"More"));return r.a.createElement(We.a,{className:t.card},r.a.createElement(Fe.a,{avatar:r.a.createElement(Be.a,{alt:i,className:t.avatar,src:c}),title:y,subheader:re()(o).fromNow()}),r.a.createElement(et.a,{className:t.content},r.a.createElement(Ze.a,{in:p,timeout:"auto",collapsedHeight:"".concat(this.collapsedHeight(),"px")},r.a.createElement(ue.a,{id:"content-"+s,ref:this.container,onLoad:this.updateContentDimensions.bind(this)},r.a.createElement(Xe.a,{source:qe(a),className:t.markdownContainer}))),this.shouldShowMore()?v:r.a.createElement("div",null)),r.a.createElement(Ge.a,{className:t.actions},g))}}]),n}(a.Component),ct=Object(f.b)((function(e){return{user:e.user}}))(L()((function(e){return{card:{marginBottom:20,position:"relative"},image:{minWidth:200},content:{padding:25,objectFit:"cover"},actions:{display:"block"},showMoreContainer:{display:"flex","justify-content":"center"},markdownContainer:{h2:{fontSize:"1em"},"& img":{width:"100%"}},showMore:{"border-radius":"20px","margin-top":"3px"}}}))(ot)),lt=n(106),it=n.n(lt),st=n(391),ut=L()((function(e){return{card:{display:"flex",marginBottom:20},cardContent:{width:"100%",flexDirection:"column",padding:25},cover:{minWidth:200,objectFit:"cover"},handle:{width:60,height:18,backgroundColor:e.palette.primary.main,marginBottom:7},date:{height:14,width:100,backgroundColor:"rgba(0,0,0,0.3)",marginBottom:10},fullLine:{height:15,width:"90%",backgroundColor:"rgba(0,0,0,0.6)",marginBottom:10},halfLine:{height:15,width:"50%",backgroundColor:"rgba(0,0,0,0.6)",marginBottom:10}}}))((function(e){var t=e.classes,n=Array.from({length:5}).map((function(e,n){return r.a.createElement(We.a,{className:t.card,key:n},r.a.createElement(st.a,{className:t.cover,image:it.a}),r.a.createElement(et.a,{className:t.cardContent},r.a.createElement("div",{className:t.handle}),r.a.createElement("div",{className:t.date}),r.a.createElement("div",{className:t.fullLine}),r.a.createElement("div",{className:t.fullLine}),r.a.createElement("div",{className:t.halfLine})))}));return r.a.createElement(a.Fragment,null,n)})),mt=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(){return Object(k.a)(this,n),t.apply(this,arguments)}return Object(x.a)(n,[{key:"componentDidMount",value:function(){this.props.getAnnouncements()}},{key:"render",value:function(){var e=this.props.data,t=e.announcements;return e.loading?r.a.createElement(ut,null):t.filter((function(e){return!e.isArchived})).map((function(e){return r.a.createElement(ct,{key:e.announcementId,announcement:e})}))}}]),n}(a.Component),dt=Object(f.b)((function(e){return{data:e.data}}),{getAnnouncements:H})(mt),pt=n(107),ht=n.n(pt),ft=n(392),Et=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(e){var a;return Object(k.a)(this,n),(a=t.call(this,e)).handleSubmit=function(e){e.preventDefault();var t={email:a.state.email,password:a.state.password};a.props.loginUser(t,a.props.history)},a.handleChange=function(e){a.setState(Object(G.a)({},e.target.name,e.target.value))},a.state={email:"",password:"",errors:[]},a}return Object(x.a)(n,[{key:"componentWillReceiveProps",value:function(e,t){e.UI.errors&&this.setState({errors:e.UI.errors})}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.UI.loading,a=this.state.errors;return r.a.createElement(ft.a,{container:!0,className:t.form},r.a.createElement(ft.a,{item:!0,sm:!0}),r.a.createElement(ft.a,{item:!0,sm:!0},r.a.createElement("img",{src:ht.a,alt:"h2",className:t.image}),r.a.createElement(ue.a,{variant:"h2",className:t.pageTitle},"Login"),r.a.createElement("form",{noValidate:!0,onSubmit:this.handleSubmit},r.a.createElement(Y.a,{id:"email",name:"email",label:"Email",className:t.textField,helperText:a.email,error:!!a.email,value:this.state.email,onChange:this.handleChange,fullWidth:!0}),r.a.createElement(Y.a,{id:"password",name:"password",label:"Password",type:"password",className:t.textField,helperText:a.password,error:!!a.password,value:this.state.password,onChange:this.handleChange,fullWidth:!0}),a.general&&r.a.createElement(ue.a,{variant:"body2",className:t.customError},a.general),r.a.createElement(K.a,{type:"submit",variant:"contained",color:"primary",className:t.button,disabled:n},"Login",n&&r.a.createElement($.a,{className:t.progress,size:30})),r.a.createElement("br",null),r.a.createElement("small",null,"don't have an account ? signup ",r.a.createElement(l.b,{to:"/signup"},"here")))),r.a.createElement(ft.a,{item:!0,sm:!0}))}}]),n}(a.Component),bt=Object(f.b)((function(e){return{UI:e.UI}}),{loginUser:function(e,t){return function(n){n({type:"LOADING_UI"}),w.a.auth().signInWithEmailAndPassword(e.email,e.password).then((function(e){return e.user.getIdToken()})).then((function(e){I(e),n(A()),n({type:"CLEAR_ERRORS"}),t.push("/")})).catch((function(e){console.log(e),n({type:"SET_ERRORS",payload:e.response.data})}))}}})(L()((function(e){return Object(y.a)({},e.rootStyles)}))(Et)),gt=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(e){var a;return Object(k.a)(this,n),(a=t.call(this,e)).handleSubmit=function(e){e.preventDefault(),a.setState({loading:!0});var t={email:a.state.email,password:a.state.password,confirmPassword:a.state.confirmPassword,handle:a.state.handle};a.props.signupUser(t,a.props.history)},a.handleChange=function(e){a.setState(Object(G.a)({},e.target.name,e.target.value))},a.state={email:"",password:"",confirmPassword:"",handle:"",errors:[]},a}return Object(x.a)(n,[{key:"componentWillReceiveProps",value:function(e,t){e.UI.errors&&this.setState({errors:e.UI.errors})}},{key:"render",value:function(){var e=this.props,t=e.classes,n=e.UI.loading,a=this.state.errors;return r.a.createElement(ft.a,{container:!0,className:t.form},r.a.createElement(ft.a,{item:!0,sm:!0}),r.a.createElement(ft.a,{item:!0,sm:!0},r.a.createElement("img",{src:ht.a,alt:"h2",className:t.image}),r.a.createElement(ue.a,{variant:"h2",className:t.pageTitle},"Signup"),r.a.createElement("form",{noValidate:!0,onSubmit:this.handleSubmit},r.a.createElement(Y.a,{id:"email",name:"email",label:"Email",className:t.textField,helperText:a.email,error:!!a.email,value:this.state.email,onChange:this.handleChange,fullWidth:!0}),r.a.createElement(Y.a,{id:"password",name:"password",label:"Password",type:"password",className:t.textField,helperText:a.password,error:!!a.password,value:this.state.password,onChange:this.handleChange,fullWidth:!0}),r.a.createElement(Y.a,{id:"confirmPassword",name:"confirmPassword",label:"Confirm Password",type:"password",className:t.textField,helperText:a.password,error:!!a.confirmPassword,value:this.state.confirmPassword,onChange:this.handleChange,fullWidth:!0}),r.a.createElement(Y.a,{id:"handle",name:"handle",label:"Username",type:"text",className:t.textField,helperText:a.handle,error:!!a.handle,value:this.state.handle,onChange:this.handleChange,fullWidth:!0}),a.general&&r.a.createElement(ue.a,{variant:"body2",className:t.customError},a.general),r.a.createElement(K.a,{type:"submit",variant:"contained",color:"primary",className:t.button,disabled:n},"Login",n&&r.a.createElement($.a,{className:t.progress,size:30})),r.a.createElement("br",null),r.a.createElement("small",null,"Already have an account ? login ",r.a.createElement(l.b,{to:"/login"},"here")))),r.a.createElement(ft.a,{item:!0,sm:!0}))}}]),n}(a.Component),yt=Object(f.b)((function(e){return{user:e.user,UI:e.UI}}),{signupUser:function(e,t){return function(n){n({type:"LOADING_UI"}),h.a.post("/signup",e).then((function(e){var a=e.data;I(a.token),n(A()),n({type:"CLEAR_ERRORS"}),t.push("/")})).catch((function(e){console.log(e),n({type:"SET_ERRORS",payload:e.response.data})}))}}})(L()((function(e){return Object(y.a)({},e.rootStyles)}))(gt)),vt=n(196),Ot=n(108),Nt=n.n(Ot),Ct=n(109),jt=n.n(Ct),St=n(110),wt=n.n(St),It=L()((function(e){return Object(y.a)(Object(y.a)({},e.rootStyles),{},{handle:{height:20,backgroundColor:e.palette.primary.main,width:60,margin:"0 auto 7px auto"},fullLine:{height:15,backgroundColor:"rgba(0,0,0,0.6)",width:"100%",marginBottom:10},halfLine:{height:15,backgroundColor:"rgba(0,0,0,0.6)",width:"50%",marginBottom:10}})}))((function(e){var t=e.classes;return r.a.createElement(vt.a,{className:t.paper},r.a.createElement("div",{className:t.profile},r.a.createElement("div",{className:"image-wrapper"},r.a.createElement("img",{src:it.a,alt:"profile",className:"profile-image"})),r.a.createElement("hr",null),r.a.createElement("div",{className:"profile-details"},r.a.createElement("div",{className:t.handle}),r.a.createElement("hr",null),r.a.createElement("div",{className:t.fullLine}),r.a.createElement("div",{className:t.fullLine}),r.a.createElement("hr",null),r.a.createElement(Nt.a,{color:"primary"}),r.a.createElement("span",null,"Location"),r.a.createElement("hr",null),r.a.createElement(jt.a,{color:"primary"}),"https://website.com",r.a.createElement("hr",null),r.a.createElement(wt.a,{color:"primary"}),"Join date")))})),At=n(393),kt=n(193),xt=n.n(kt),Ut=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(k.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={bio:"",website:"",location:"",open:!1},e.handleClose=function(){e.setState({open:!1})},e.mapUserDetailsToState=function(t){e.setState({bio:t.bio?t.bio:"",website:t.website?t.website:"",location:t.location?t.location:""})},e.handleOpen=function(){e.setState({open:!0}),e.mapUserDetailsToState(e.props.credentials)},e.handleChange=function(t){e.setState(Object(G.a)({},t.target.name,t.target.value))},e.handleSubmit=function(){var t={bio:e.state.bio,website:e.state.website,location:e.state.location};e.props.editUserDetails(t),e.handleClose()},e}return Object(x.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.credentials;this.mapUserDetailsToState(e)}},{key:"render",value:function(){var e=this.props.classes;return r.a.createElement(a.Fragment,null,r.a.createElement(B,{tip:"Edit details",onClick:this.handleOpen,btnClassName:e.button},r.a.createElement(Ie.a,{color:"primary"})),r.a.createElement(V.a,{open:this.state.open,onClose:this.handleClose,fullWidth:!0,maxWidth:"sm"},r.a.createElement(X.a,null,"Edit your details"),r.a.createElement(J.a,null,r.a.createElement("form",null,r.a.createElement(Y.a,{name:"bio",type:"text",label:"Bio",multiline:!0,rows:"3",placeholder:"A short bio of yourself",className:e.textField,value:this.state.bio,onChange:this.handleChange,fullWidth:!0}),r.a.createElement(Y.a,{name:"website",type:"text",label:"Website",multiline:!0,placeholder:"Your personal website",className:e.textField,value:this.state.website,onChange:this.handleChange,fullWidth:!0}),r.a.createElement(Y.a,{name:"location",type:"text",label:"Location",multiline:!0,placeholder:"Where you live",className:e.textField,value:this.state.location,onChange:this.handleChange,fullWidth:!0}))),r.a.createElement(Re.a,null,r.a.createElement(K.a,{onClick:this.handleClose,color:"primary"},"Cancel"),r.a.createElement(K.a,{onClick:this.handleSubmit,color:"primary"},"Submit"))))}}]),n}(a.Component),Tt=Object(f.b)((function(e){return{credentials:e.user.credentials}}),{editUserDetails:function(e){return function(t){t({type:"LOADING_USER"}),h.a.post("/user",e).then((function(){t(A())})).catch((function(e){return console.log(e)}))}}})(L()((function(e){return Object(y.a)(Object(y.a)({},e.rootStyles),{},{button:{float:"right"}})}))(Ut)),_t=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(e){var a;return Object(k.a)(this,n),(a=t.call(this,e)).handleImageChange=function(e){var t=e.target.files[0],n=new FormData;n.append("image",t,t.name),a.props.uploadImage(n)},a.handleEditPicture=function(){a.imageButtonRef.current.click()},a.handleLogout=function(){a.props.logoutUser()},a.imageButtonRef=r.a.createRef(),a}return Object(x.a)(n,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.user,o=n.credentials,c=o.handle,i=o.createdAt,s=o.imageUrl,u=o.bio,m=o.website,d=o.location,p=n.loading,h=n.authenticated;return p?r.a.createElement(It,null):h?r.a.createElement(vt.a,{className:t.paper},r.a.createElement("div",{className:t.profile},r.a.createElement("div",{className:"image-wrapper"},r.a.createElement("img",{src:s,alt:"profile",className:"profile-image"}),r.a.createElement("input",{type:"file",id:"imageInput",hidden:"hidden",onChange:this.handleImageChange,ref:this.imageButtonRef}),r.a.createElement(B,{tip:"Edit profile picture",onClick:this.handleEditPicture,btnClassName:"button"},r.a.createElement(Ie.a,{color:"primary"}))),r.a.createElement("hr",null),r.a.createElement("div",{className:"profile-details"},r.a.createElement(At.a,{component:l.b,to:"/users/".concat(c),color:"primary",variant:"h5"},"@",c),u&&r.a.createElement(ue.a,{variant:"body2"},u),r.a.createElement("hr",null),d&&r.a.createElement(a.Fragment,null,r.a.createElement(Nt.a,{color:"primary"}),r.a.createElement("span",null,d)),r.a.createElement("hr",null),m&&r.a.createElement(a.Fragment,null,r.a.createElement(jt.a,{color:"primary"}),r.a.createElement("a",{href:m,target:"_blank",rel:"noopener noreferrer"},"  ",m)),r.a.createElement("hr",null),r.a.createElement(wt.a,{color:"primary"}),"  ",r.a.createElement("span",null,"Joined ",re()(i).format("MMM YYYY")))),r.a.createElement(M.a,{title:"Logout",placement:"top"},r.a.createElement(B,{tip:"Logout",onClick:this.handleLogout},r.a.createElement(xt.a,{color:"primary"}))),r.a.createElement(Tt,null)):r.a.createElement(vt.a,{className:t.paper},r.a.createElement(ue.a,{variant:"body2",aligh:"center"},"No profile found, please login again"),r.a.createElement("div",{className:t.buttons},r.a.createElement(K.a,{variant:"contained",color:"primary",component:l.b,to:"/login"},"Login"),r.a.createElement(K.a,{variant:"contained",color:"secondary",component:l.b,to:"/signup"},"Signup")))}}]),n}(a.Component),Rt=Object(f.b)((function(e){return{user:e.user}}),{logoutUser:function(){return function(e){w.a.auth().signOut().then((function(){e({type:"SET_UNAUTHENTICATED"})}))}},uploadImage:function(e){return function(t){t({type:"LOADING_USER"}),h.a.post("/user/image",e).then((function(e){t(A())})).catch((function(e){return console.log(e)}))}}})(L()((function(e){return Object(y.a)({},e.rootStyles)}))(_t)),Dt=function(e){Object(U.a)(n,e);var t=Object(T.a)(n);function n(){var e;Object(k.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={profile:{},announcementIdParam:null},e}return Object(x.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.handle,n=this.props.match.params.announcementId;n&&this.setState({announcementIdParam:n}),this.props.getUserData(t),h.a.get("/user/".concat(t)).then((function(t){e.setState({profile:t.data.user})})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){var e=this.props.data,t=e.announcements,n=e.loading,a=this.state.announcementIdParam,o=n?r.a.createElement(ut,null):null===t?r.a.createElement("p",null,"No announcements from this user"):a?t.map((function(e){return e.announcementId!==a?r.a.createElement(ct,{key:e.announcementId,announcement:e}):r.a.createElement(ct,{key:e.announcementId,announcement:e,openDialog:!0})})):t.map((function(e){return r.a.createElement(ct,{key:e.announcementId,announcement:e})}));return r.a.createElement(ft.a,{container:!0,spacing:10},r.a.createElement(ft.a,{item:!0,sm:8,xs:12},o),r.a.createElement(ft.a,{item:!0,sm:4,xs:12},this.state.profile?r.a.createElement(Rt,null):r.a.createElement(It,null)))}}]),n}(a.Component),Lt=Object(f.b)((function(e){return{data:e.data,UI:e.UI}}),{getUserData:function(e){return function(t){t({type:"LOADING_DATA"}),h.a.get("/user/".concat(e)).then((function(e){t({type:"SET_ANNOUNCEMENTS",payload:e.data.announcements})})).catch((function(){t({type:"SET_ANNOUNCEMENTS",payload:null})}))}}})(Dt),Mt=(n(342),m()(d));w.a.initializeApp({apiKey:"AIzaSyCCx9TDJtVzEaPym1OyU5KSuWgwslGDzEY"}),w.a.auth().onAuthStateChanged((function(e){e&&e.getIdToken().then((function(e){I(e),S.dispatch(A())}))})),h.a.defaults.baseURL="https://us-central1-h2-app.cloudfunctions.net/api";var Pt=function(){return r.a.createElement(s.a,{theme:Mt},r.a.createElement(f.a,{store:S},r.a.createElement(l.a,null,r.a.createElement(Ne,null),r.a.createElement("div",{className:"container"},r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/",component:dt}),r.a.createElement(je,{exact:!0,path:"/login",component:bt}),r.a.createElement(je,{exact:!0,path:"/signup",component:yt}),r.a.createElement(i.b,{exact:!0,path:"/users/:handle",component:Lt}),r.a.createElement(i.b,{exact:!0,path:"/users/:handle/announcement/:announcementId",component:Lt}))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Pt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[209,1,2]]]);
//# sourceMappingURL=main.d51c57a7.chunk.js.map